{% extends 'blog/base.html' %}

{% load static %}
{% load comments %}

{% block blogpage_title %}| {{ post.title }}{% endblock %}

{% block extra_css %}

    {{ block.super }}
    <link rel="stylesheet" type="text/css" href="{% get_static_prefix %}css/comments.css" />

{% endblock %}

{% block main_content %}

    <h2 class="blog_post_heading">{{ post.title }}</h2>

    <h3 class="blog_post_dateline">{{ post.publication_date }} | {% for tag in post.tags.all %}{% if not forloop.first %}, {% endif %}<a href="/blog/tag/{{ tag.name }}">{{ tag.name }}</a>{% endfor %}</h3>
    
    {{ post.body|safe }}
    
    {% get_comment_count for post as comment_count %}

    <hr />

    <div class="comments_section">
        
        {% if comment_count %}<p class="comments_heading"><strong>{{ comment_count }} comment{{ comment_count|pluralize }}
        </strong></p>{% endif %}
        
        {% get_comment_list for post as comment_list %}

        <ol>
        {% for comment in comment_list %}

            <a name="c{{ comment.id }}" id="c{{ comment.id }}"></a>
            <li>{{ comment.user_name }} &ndash; <a href="{% get_comment_permalink comment %}">{{ comment.submit_date }}</a>
                <blockquote>
                {{ comment.comment }}
                </blockquote>
            </li>

        {% endfor %}
        </ol>

        <p class="comments_heading"><strong>Post a comment.</strong></p>
        
        {% get_comment_form for post as form %}
        
        <form action="{% comment_form_target %}" method="post">
            {% csrf_token %}
            {{ form.as_p }}
            <input type="hidden" name="next" value="{{ post.get_absolute_url }}" />
            <p class="submit">
                <input type="submit" name="post" class="submit-post" value="Post" />
                <input type="submit" name="preview" class="submit-preview" value="Preview" />
            </p>
        </form>

    </div>
{% endblock %}
